# HTTP Enumeration

Gobuster
----------
Gobuster is a command line tool, available on windows and linux. It is the most complete tool in my opinion. Firstly because it offers many features like brute force url, vhost or DNS.

Secondly because it is very simple to use and faster than its competitors: dirbuster, dirb or Metasploit to name a few.

Last but not least because it offers multiple options such as adding extensions, brute force HTTP post and get parameters etc ....


### Gobuster Modes
It has three main modes it can be used with:

- dir - the classic directory brute-forcing mode
- dns - DNS subdomain brute-forcing mode
- vhost - virtual host brute-forcing mode (not the same as DNS!)

Running the help gives us the following.

````
~$ gobuster help
Usage:
  gobuster [command]

Available Commands:
  dir         Uses directory/file brutceforcing mode
  dns         Uses DNS subdomain bruteforcing mode
  help        Help about any command
  vhost       Uses VHOST bruteforcing mode

Flags:
  -h, --help              help for gobuster
  -z, --noprogress        Don't display progress
  -o, --output string     Output file to write results to (defaults to stdout)
  -q, --quiet             Don't print the banner and other noise
  -t, --threads int       Number of concurrent threads (default 10)
  -v, --verbose           Verbose output (errors)
  -w, --wordlist string   Path to the wordlist

Use "gobuster [command] --help" for more information about a command.
````

#### dir mode
Now for the dir specific flags, the help is pretty self-explainatory but it is best to spend some time on commenting some flags that might come up more often in our tests.

````
~$ gobuster dir --help
Uses directory/file brutceforcing mode

Usage:
  gobuster dir [flags]

Flags:
  -f, --addslash                      Apped / to each request
  -c, --cookies string                Cookies to use for the requests
  -e, --expanded                      Expanded mode, print full URLs
  -x, --extensions string             File extension(s) to search for
  -r, --followredirect                Follow redirects
  -H, --headers stringArray           Specify HTTP headers, -H 'Header1: val1' -H 'Header2: val2'
  -h, --help                          help for dir
  -l, --includelength                 Include the length of the body in the output
  -k, --insecuressl                   Skip SSL certificate verification
  -n, --nostatus                      Don't print status codes
  -P, --password string               Password for Basic Auth
  -p, --proxy string                  Proxy to use for requests [http(s)://host:port]
  -s, --statuscodes string            Positive status codes (will be overwritten with statuscodesblacklist if set) (default "200,204,301,302,307,401,403")
  -b, --statuscodesblacklist string   Negative status codes (will override statuscodes if set)
      --timeout duration              HTTP Timeout (default 10s)
  -u, --url string                    The target URL
  -a, --useragent string              Set the User-Agent string (default "gobuster/3.0.1")
  -U, --username string               Username for Basic Auth
      --wildcard                      Force continued operation when wildcard found
````

In many cases especially in CTF like events the SSL certifications are self signed and therefore not verified. Gobuster using the flag -k allows us to skip SSL verification and continue our pentesting unbothered. Another thing that comes in pretty handy is that we are able to define which status codes are valid for our test and which are not. This is done through the -s and -b flags where the -s flag works like a whitelist filter and the -b as a blacklist filter.

A question that comes up often is, how to specify Gobuster which files to search for? This is done using the -x flag where we can specify the file extensions we are looking for. For example if I am looking for images i could use something similar to -x jpg,png,gif.

Following there is a basic example running gobuster in dir mode.

````
gobuster dir -u http://192.168.1.1 -w my_wordlist.txt
````


There are other similar ones like dirb, dirbuster etc..

#### DNS mode
In the DNS mode we are looking to find subdomains of a specific domain. This is very important in penetration testing as it might reveal areas not as well protected as others.

Lets start here also by showing the help.

```
$ gobuster help dns

Uses DNS subdomain bruteforcing mode

Usage:
  gobuster dns [flags]

Flags:
  -d, --domain string      The target domain
  -h, --help               help for dns
  -r, --resolver string    Use custom DNS server (format server.com or server.com:port)
  -c, --showcname          Show CNAME records (cannot be used with '-i' option)
  -i, --showips            Show IP addresses
      --timeout duration   DNS resolver timeout (default 1s)
      --wildcard           Force continued operation when wildcard found
```

The first thing we notice in the help is the -d flag which is used to specify the domain name we want. As you can figure out from the name of the mode, gobuster actually tries to DNS resolve the subdomains it tries so it can verify if they exist or not. As there are cases in pentesting where a specific DNS server is required to be used, Gobuster gives us the possibility to do so using the -r flag.

We are not going to spend time analyzing all flags as it is pretty straightforward to understand them. We are going directly to see an example of running Gobuster in dns mode.

````
gobuster dns -d http://42.42.42.42 -w my_wordlist.txt -i
````

### VHOST mode
This mode should not be mistaken to be the same as the DNS mode. In the DNS mode the tool attempts to DNS resolve the subdomains and based on that we are given the result. In vhosts mode the tool is checking if the subdomain exists by visiting the formed url and verifying the IP address. The following shows the output from the help command

````
~$ gobuster vhost --help
Uses VHOST bruteforcing mode

Usage:
  gobuster vhost [flags]

Flags:
  -c, --cookies string        Cookies to use for the requests
  -r, --followredirect        Follow redirects
  -H, --headers stringArray   Specify HTTP headers, -H 'Header1: val1' -H 'Header2: val2'
  -h, --help                  help for vhost
  -k, --insecuressl           Skip SSL certificate verification
  -P, --password string       Password for Basic Auth
  -p, --proxy string          Proxy to use for requests [http(s)://host:port]
      --timeout duration      HTTP Timeout (default 10s)
  -u, --url string            The target URL
  -a, --useragent string      Set the User-Agent string (default "gobuster/3.0.1")
  -U, --username string       Username for Basic Auth
````

You can see that the flags are a subset from the flags in DIR mode. Once again it is straight forward what its flag is useful for so we are not spending time on that.

````
gobuster vhost -u http://10.10.1.1 -w my_wordlist.txt
````

### Useful Wordlists
As for the wordlists, you have different possibilities. Indeed, several wordlists are present by default in kali.

- /usr/share/wordlists/dirbuster/directory-list-2.3-*.txt
- /usr/share/wordlists/dirbuster/directory-list-1.0.txt
- /usr/share/wordlists/dirb/big.txt
- /usr/share/wordlists/dirb/common.txt
- /usr/share/wordlists/dirb/small.txt
- /usr/share/wordlists/dirb/extensions_common.txt - Useful for when fuzzing for files!
    
**Non-Standard Lists**
    
In addition to the above, Daniel Miessler has created an amazing GitHub repo called SecLists. It compiles many different lists used for many different things. The best part is, it's in apt! You can sudo apt install seclists and get the entire repo! We won't dive into any other lists as there are many. However, between what's installed by default on Kali and the SecLists repo, I doubt you'll need anything else.

````sudo apt-get install seclists````

Note that not all words are present in all lists. So vary the lists during your brute force. I advise you to start with "common.txt" and if you don't find anything go to "directory-list".


curl 
-------

Please, follow this link : 
- https://vk9-sec.com/http-https-enumeration-using-curl/
- https://flaviocopes.com/http-curl/

Wappalyzer
------- 
Wappalyzer is a browser extension that uncovers the technologies used on websites. It detects content management systems, web shops, web servers, JavaScript frameworks, analytics tools and many more.

- chrome : https://chrome.google.com/webstore/detail/wappalyzer-technology-pro/gppongmhjkpfnbhagpmjfkannfbllamg

- Firefox : https://addons.mozilla.org/fr/firefox/addon/wappalyzer/


Nikto
-----
Nikto is a security scanner for web servers, and is programmed in P.E.R.L. Its features are to audit your web servers for various vulnerabilities, to test potentially about 6000 CGI vulnerabilities and dangerous files, to check the obsolescence of the server and its software components, to search for folders that may contain sensitive information.

Please, follow this link : 
- https://hackertarget.com/nikto-tutorial/
- https://techyrick.com/nikto-2/

## Exercises 

IP : 10.12.1.36

1. How many files could you find on port 80?
    > > Hundreds. The result relies on the wordlist utilized. In this case, I used:
    > /usr/share/wordlists/dirbuster/directory-list-1.0.txt
    > /usr/share/wordlists/dirb/common.txt
    > With these 2 wordlists, we have 3 directories.
    > Metasploitable was able to find 4 more distinctive directories = **7 directories**

COMMANDS:
    
    METASPLOIT:
    ```bash
        msfconsole
        msf6 > use auxiliary/scanner/http/dir_scanner
        msf6 auxiliary(scanner/http/dir_scanner) > show options
        msf6 auxiliary(scanner/http/dir_scanner) > set RHOSTS 10.12.1.36
        msf6 auxiliary(scanner/http/dir_scanner) > run
    ```

    [GOBUSTER](https://github.com/OJ/gobuster):
    ```bash
    gobuster dir -u http://10.12.1.36 -w /usr/share/wordlists/dirb/common.txt
    ```
    > see docs/gobuster_big.txt

    [FEROXBUSTER](https://github.com/epi052/feroxbuster):
    ```bash
    feroxbuster -u http://10.12.1.36 -w /usr/share/wordlists/dirb/common.txt --silent
    ```   


1. What is the version of apache?

    > Your response : APACHE httpd 2.2.8
    
    > command : sudo nmap -sV 10.12.1.36 -p 80
    
1. What is the version of php ?
    > Your response: PHP/5.2.4
    > command : curl -i http://10.12.1.36

1. What server extension is installed?
    > Your response : Apache/2.2.8 (Ubuntu)DAV

1. What is the name of the file in testoutput?
    > Your response :  File located at http://10.12.1.36/test/testoutput **ESAPI_logging_file_test**

1. Do a scan with Nikto on port 80.
    > Your response  : nikto -host 10.12.1.36
    
1. What curl command can you use to see the server version?
    > Your response : curl -i http://10.12.1.36

1. What tool for enumerating files does it do recursively? (By default)
    > Your response : dirbuster

1. What other administration application is currently also on port 80?
    > phpMyAdmin, according to the Metasploit scan.
